<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A Gradient Descent into Government Spending</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-2fef5ea3f8957b3e4ecc936fc74692ca.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-7743677462be8d8dc1a344ceaec86ef0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-0d28f63e8dc0f4757ec17dab479fc92c.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-7743677462be8d8dc1a344ceaec86ef0.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="A Gradient Descent into Government Spending">
<meta name="citation_author" content="Rudy Apodaca">
<meta name="citation_author" content="Edward Miranda">
<meta name="citation_language" content="en">
<meta name="citation_reference" content="citation_title=A guide to backward paper writing for the data sciences;,citation_abstract=Summary In this perspective, we outline a set of best practices for the planning, writing, and revision of scientific papers and other forms of professional communication in the data sciences. We propose a backward approach that begins with clearly identifying the scientific and professional goals motivating the work, followed by a purposeful mapping from those goals to each section of a paper. This approach is motivated by the conviction that manuscript writing can be more effective, efficient, creative, and even enjoyable—particularly for early-career researchers—when the overarching goals of the paper and its individual components are clearly mapped out.;,citation_author=Jon Zelner;,citation_author=Kelly Broen;,citation_author=Ella August;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_fulltext_html_url=https://www.sciencedirect.com/science/article/pii/S2666389921003068;,citation_issue=3;,citation_doi=10.1016/j.patter.2021.100423;,citation_issn=2666-3899;,citation_volume=3;,citation_journal_title=Patterns;">
</head>

<body class="quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">A Gradient Descent into Government Spending</h1>
            <p class="subtitle lead">How is a public company’s short-term stock price influenced by Government Contract Activity, starting market cap, and financial sector?</p>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                <div>
            <div class="quarto-title-meta-heading">Authors</div>
            <div class="quarto-title-meta-contents">
                        <p>Rudy Apodaca </p>
                        <p>Edward Miranda </p>
                      </div>
          </div>
                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul class="collapse">
  <li><a href="#value-for-the-american-people" id="toc-value-for-the-american-people" class="nav-link" data-scroll-target="#value-for-the-american-people"><span class="header-section-number">1.1</span> Value for the American People</a></li>
  <li><a href="#navigating-mistrust" id="toc-navigating-mistrust" class="nav-link" data-scroll-target="#navigating-mistrust"><span class="header-section-number">1.2</span> Navigating Mistrust</a></li>
  <li><a href="#leveling-the-playing-field" id="toc-leveling-the-playing-field" class="nav-link" data-scroll-target="#leveling-the-playing-field"><span class="header-section-number">1.3</span> Leveling the Playing Field</a></li>
  </ul></li>
  <li><a href="#background" id="toc-background" class="nav-link" data-scroll-target="#background"><span class="header-section-number">2</span> Background</a>
  <ul class="collapse">
  <li><a href="#what-makes-a-market" id="toc-what-makes-a-market" class="nav-link" data-scroll-target="#what-makes-a-market"><span class="header-section-number">2.1</span> What Makes a Market?</a></li>
  <li><a href="#predicting-prices" id="toc-predicting-prices" class="nav-link" data-scroll-target="#predicting-prices"><span class="header-section-number">2.2</span> Predicting Prices</a></li>
  <li><a href="#determining-market-activity" id="toc-determining-market-activity" class="nav-link" data-scroll-target="#determining-market-activity"><span class="header-section-number">2.3</span> Determining Market Activity</a></li>
  <li><a href="#government-contract-awards-process" id="toc-government-contract-awards-process" class="nav-link" data-scroll-target="#government-contract-awards-process"><span class="header-section-number">2.4</span> Government Contract Awards Process</a></li>
  </ul></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">3</span> Data</a>
  <ul class="collapse">
  <li><a href="#sources" id="toc-sources" class="nav-link" data-scroll-target="#sources"><span class="header-section-number">3.1</span> Sources</a>
  <ul class="collapse">
  <li><a href="#usa-spending" id="toc-usa-spending" class="nav-link" data-scroll-target="#usa-spending"><span class="header-section-number">3.1.1</span> USA Spending</a></li>
  <li><a href="#nasdaq" id="toc-nasdaq" class="nav-link" data-scroll-target="#nasdaq"><span class="header-section-number">3.1.2</span> Nasdaq</a></li>
  <li><a href="#yahoo-finance-via-yfinance" id="toc-yahoo-finance-via-yfinance" class="nav-link" data-scroll-target="#yahoo-finance-via-yfinance"><span class="header-section-number">3.1.3</span> Yahoo Finance (via yFinance)</a></li>
  </ul></li>
  <li><a href="#data-engineering---extract-transform-load-etl" id="toc-data-engineering---extract-transform-load-etl" class="nav-link" data-scroll-target="#data-engineering---extract-transform-load-etl"><span class="header-section-number">3.2</span> Data Engineering - Extract, Transform, &amp; Load (ETL)</a>
  <ul class="collapse">
  <li><a href="#extract" id="toc-extract" class="nav-link" data-scroll-target="#extract"><span class="header-section-number">3.2.1</span> Extract</a></li>
  <li><a href="#transform" id="toc-transform" class="nav-link" data-scroll-target="#transform"><span class="header-section-number">3.2.2</span> Transform</a></li>
  <li><a href="#load" id="toc-load" class="nav-link" data-scroll-target="#load"><span class="header-section-number">3.2.3</span> Load</a></li>
  </ul></li>
  <li><a href="#exploration" id="toc-exploration" class="nav-link" data-scroll-target="#exploration"><span class="header-section-number">3.3</span> Exploration</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis"><span class="header-section-number">3.4</span> Analysis</a>
  <ul class="collapse">
  <li><a href="#why-xgboost-was-chosen" id="toc-why-xgboost-was-chosen" class="nav-link" data-scroll-target="#why-xgboost-was-chosen"><span class="header-section-number">3.4.1</span> Why XGBoost Was Chosen</a></li>
  <li><a href="#xgboost-vs.-random-forest-and-logistic-regression" id="toc-xgboost-vs.-random-forest-and-logistic-regression" class="nav-link" data-scroll-target="#xgboost-vs.-random-forest-and-logistic-regression"><span class="header-section-number">3.4.2</span> XGBoost vs.&nbsp;Random Forest and Logistic Regression</a></li>
  <li><a href="#loss-function" id="toc-loss-function" class="nav-link" data-scroll-target="#loss-function"><span class="header-section-number">3.4.3</span> Loss Function</a></li>
  <li><a href="#pseudo-huber" id="toc-pseudo-huber" class="nav-link" data-scroll-target="#pseudo-huber"><span class="header-section-number">3.4.4</span> Pseudo-Huber</a></li>
  <li><a href="#feature-engineering-and-importance" id="toc-feature-engineering-and-importance" class="nav-link" data-scroll-target="#feature-engineering-and-importance"><span class="header-section-number">3.4.5</span> Feature Engineering and Importance</a></li>
  <li><a href="#feature-importance-interpretation" id="toc-feature-importance-interpretation" class="nav-link" data-scroll-target="#feature-importance-interpretation"><span class="header-section-number">3.4.6</span> Feature Importance Interpretation</a></li>
  <li><a href="#shap-interpreting-model-behavior" id="toc-shap-interpreting-model-behavior" class="nav-link" data-scroll-target="#shap-interpreting-model-behavior"><span class="header-section-number">3.4.7</span> SHAP: Interpreting Model Behavior</a></li>
  <li><a href="#feature-interpretability-and-model-insights" id="toc-feature-interpretability-and-model-insights" class="nav-link" data-scroll-target="#feature-interpretability-and-model-insights"><span class="header-section-number">3.4.8</span> Feature Interpretability and Model Insights</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results"><span class="header-section-number">4</span> Results</a>
  <ul class="collapse">
  <li><a href="#post-tuning" id="toc-post-tuning" class="nav-link" data-scroll-target="#post-tuning"><span class="header-section-number">4.0.1</span> Post-Tuning</a></li>
  <li><a href="#sample-predictions" id="toc-sample-predictions" class="nav-link" data-scroll-target="#sample-predictions"><span class="header-section-number">4.0.2</span> Sample Predictions</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions"><span class="header-section-number">5</span> Conclusions</a>
  <ul class="collapse">
  <li><a href="#ethical-considerations" id="toc-ethical-considerations" class="nav-link" data-scroll-target="#ethical-considerations"><span class="header-section-number">5.1</span> Ethical Considerations</a>
  <ul class="collapse">
  <li><a href="#privacy" id="toc-privacy" class="nav-link" data-scroll-target="#privacy"><span class="header-section-number">5.1.1</span> Privacy</a></li>
  <li><a href="#biases" id="toc-biases" class="nav-link" data-scroll-target="#biases"><span class="header-section-number">5.1.2</span> Biases</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">




  


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<section id="value-for-the-american-people" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="value-for-the-american-people"><span class="header-section-number">1.1</span> Value for the American People</h2>
<p>Now, more than ever, voters in the United States are paying attention to how the government uses its funds. Ninety-eight percent of Americans believe there is at least some waste, fraud, and abuse in federal government, and seventy-six percent of surveyed Americans believe the government spends too much money (Cato Institute: Ekins, Johnson). During the 2024 presidential election, much of the rhetoric used in campaign efforts was geared towards addressing Americans’ concerns surrounding perceived overspending by the federal government.</p>
</section>
<section id="navigating-mistrust" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="navigating-mistrust"><span class="header-section-number">1.2</span> Navigating Mistrust</h2>
<p>Mistrust in the U.S. government can also lead to suspicions of corruption by those who wield access to privileged information. Various sites have been created to closely monitor politicians’ public stock trades with the goal of exposing corrupt practices like insider trading. Insider trading is the act of buying, selling, or holding stock market positions based on non public information. Politicians commonly associated with insider trading include Nancy Pelosi (fmr. D-CA) and Marjorie Taylor Greene (R-GA), although neither have had legal charges brought. Insider information includes upcoming unannounced legislation (which could benefit certain industries) and undisclosed selection decisions for awarding government contracts, which will be the focus of this analysis.</p>
<p>While some argue that politicians should not be allowed to trade in the stock market due to potential advanced knowledge of the information mentioned here, such policies are not currently enacted. Proving a politician commited insider trading could be tricky due to the various methods of occulting such practices (shell companies, third party entities), and the wide timeframe required to disclose financial events.</p>
</section>
<section id="leveling-the-playing-field" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="leveling-the-playing-field"><span class="header-section-number">1.3</span> Leveling the Playing Field</h2>
<p>Investing in government-supported companies should not be considered nefarious, however, the unfair advantage given to insiders is. Government contract data are publicly disclosed, yet most Americans likely do not know how to access them to make an informed investing decision. Our work and analysis is aimed at creating a tool to enable Americans to optimize their benefit from government spending, using publicly-available information.</p>
</section>
</section>
<section id="background" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Background</h1>
<section id="what-makes-a-market" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="what-makes-a-market"><span class="header-section-number">2.1</span> What Makes a Market?</h2>
<p>Generally a company is considered either private or public - each designation comes with positive and negative implications. Public companies must file certain financial disclosures with the Securities and Exchange Commission (SEC), a governmental organization tasked with regulating the market trading. Private companies are not required to file such disclosures with SEC. Private companies typically amass funding via private investors, while public companies are able to trade portions of equity for money on market infrastructure known as an “exchange” and broadly regarded to as the stock market. The stock market behaves similar to other financial institutions in the sense that the market opens and closes at a set hour each day, and is <strong>closed on all major holidays</strong>. Every morning, each company’s price is published, known as the opening price (or simply “open”) and each evening, the closing price (“close”) is published. Trading can happen at any time after closing and is referred to as “after-hours trading” and can cause the stock price to change since the time it closed the previous day.</p>
</section>
<section id="predicting-prices" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="predicting-prices"><span class="header-section-number">2.2</span> Predicting Prices</h2>
<p>Just about anybody with a phone, internet connection, and money can become an investor in the stock market. When deciding which stock to purchase, investors rely on key information <em>specific to each company</em>.</p>
<p>One metric is the Earnings per Share (EPS), which is essentially calculated by dividing that company’s profits (over a set period of time) by the number of shares that are available to purchase, also known as <em>outstanding shares</em>.</p>
<p><span id="eq-poisson"><span class="math display">\[
\begin{aligned}
\text{Profit} &amp;= \text{Revenue - Expenses}
\end{aligned}
\tag{1}\]</span></span></p>
<p>The timeframe can be any length of time, but generally is calculated each quarter and discussed at the company’s Earnings Call. Publicly-traded companies typically hold <strong>Earnings Calls</strong> where their representatives share the company’s financial outcomes for the previous quarter.</p>
<p><span id="eq-poisson"><span class="math display">\[
\begin{aligned}
\text{Earnings per Share} &amp;= \frac{\text{Profits}}{\text{Outstanding Shares}}
\end{aligned}
\tag{2}\]</span></span></p>
<p>When comparing companies for potential investments, it is important to compare similar companies. A common method of categorization is by Market Capitalization, or Market Cap. Market Cap is simply a company’s stock price multiplied by the number of outstanding shares. It’s evident by this definition, that a company’s Market Cap can change at practically any time. During earnings calls, an average of the stock price over the quarter is used to calculate Market Cap, barring any outlandish fluctuations in stock price.</p>
<p><span id="eq-poisson"><span class="math display">\[
\begin{aligned}
\text{Market Cap} &amp;= \text{Stock Price} \times \text{Outstanding Shares}
\end{aligned}
\tag{3}\]</span></span></p>
</section>
<section id="determining-market-activity" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="determining-market-activity"><span class="header-section-number">2.3</span> Determining Market Activity</h2>
<p>Market reactions are driven by a variety of factors, ranging from detailed historical analysis to casual public remarks made by a company’s Chief Executive Officer (CEO). In the financial industry, professional traders make decisions based on market expectations, which are informed by several key indicators and serve as benchmarks for investment strategies [2].</p>
<p>Factors that help approximate market expectations include:</p>
<ul>
<li>Revenue</li>
<li>Net profits</li>
<li>Forward-looking outlooks</li>
<li>Unexpected developments or announcements</li>
<li>And, importantly for our study: government contract awards</li>
</ul>
<p>Our approach focuses on a company’s profitability as it relates to government contracts — a substantial and traceable source of revenue. Using historical stock data, we compare a company’s actual stock performance following a contract award to market expectations. We define the <strong>Surprise Percentage</strong> as the percent difference between actual and expected performance as the Surprise Percentage (SP):</p>
<p><span id="eq-poisson"><span class="math display">\[
\begin{aligned}
\text{SP} &amp;= \text{Surprise Percentage} \\
\text{A} &amp;= \text{Actual} \\
\text{ME} &amp;= \text{Market Expectation} \\
\\
\text{SP} &amp;= \frac{A - ME}{A} \times 100
\end{aligned}
\tag{4}\]</span></span></p>
<p>We have insight into a large chunk of a company’s income, via the government contracts, so this will be our main feature of interest. In addition, we will explore the market activity within specified time periods before and after a government contract is awarded.</p>
</section>
<section id="government-contract-awards-process" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="government-contract-awards-process"><span class="header-section-number">2.4</span> Government Contract Awards Process</h2>
<p>There are several pathways through which a company can be awarded a government contract. Typically, the final decision is made by a contracting officer, a government official authorized to enter into and manage contractual agreements on behalf of a federal agency. The contracting officer collaborates with subject matter experts within their agency to establish specific evaluation criteria for selecting vendors.</p>
<p>One common method is the Lowest Price Technically Acceptable (LPTA) approach, often referred to as awarding the contract to the “lowest bidder.” In this process, the contract is awarded to the vendor who offers the lowest price while still meeting the minimum technical requirements.</p>
<p>An alternative method involves a best-value tradeoff, which assesses the overall value delivered per dollar spent. This method considers factors such as technical quality, past performance, and long-term benefits and not just cost. Best-value selections tend to be more complex and require greater subject-matter expertise to evaluate properly.</p>
</section>
</section>
<section id="data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Data</h1>
<section id="sources" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sources"><span class="header-section-number">3.1</span> Sources</h2>
<p>Our dataset is comprised of information from three sources, each requiring a unique blend of Extraction, Transformation, and Loading into our database.</p>
<div id="fig-data-sources" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-data-sources-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./images/sources.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;1: Data sources"><img src="./images/sources.png" class="img-fluid figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-data-sources-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Data sources
</figcaption>
</figure>
</div>
<section id="usa-spending" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="usa-spending"><span class="header-section-number">3.1.1</span> USA Spending</h3>
<p>USA Spending (USASpending.gov) is operated by the United States federal government and posts details about federal contracts that have been awarded. Information presented here include: the award date, company’s name, industrial sector, services contracted, and contract amount.</p>
</section>
<section id="nasdaq" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="nasdaq"><span class="header-section-number">3.1.2</span> Nasdaq</h3>
<p>Nasdaq is one of the securities exchanges in the United States. Not every publicly-traded company is listed on the Nasdaq, however, Nasdaq does post information such as company name and ticker symbol for each company listed on the Nasdaq and other exchanges.</p>
</section>
<section id="yahoo-finance-via-yfinance" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="yahoo-finance-via-yfinance"><span class="header-section-number">3.1.3</span> Yahoo Finance (via yFinance)</h3>
<p>Yahoo Finance is a highly-respected platform for viewing stock market data and related news. Independent contributors have created yFinance, a package available via the Python platform, along with others. Yahoo Finance and yFinance are not affiliated, rather the makers of yFinance extract data from Yahoo Finance’s site and publish it for public use.</p>
</section>
</section>
<section id="data-engineering---extract-transform-load-etl" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="data-engineering---extract-transform-load-etl"><span class="header-section-number">3.2</span> Data Engineering - Extract, Transform, &amp; Load (ETL)</h2>
<p>Our ETL process was not linear. Before we could call our final stock data, we needed stock ticker data and contract award dates. This information would allow us to focus our API calls fro myFinance. Below is an overview at our ETL process.</p>
<div id="fig-etl" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-etl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./images/etl_swimlanes.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;2: A generalized view of the extraction, transformation, and loading process."><img src="./images/etl_swimlanes.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-etl-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: A generalized view of the extraction, transformation, and loading process.
</figcaption>
</figure>
</div>
<section id="extract" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="extract"><span class="header-section-number">3.2.1</span> Extract</h3>
<section id="usa-spending-1" class="level4" data-number="3.2.1.1">
<h4 data-number="3.2.1.1" class="anchored" data-anchor-id="usa-spending-1"><span class="header-section-number">3.2.1.1</span> <em>USA Spending</em></h4>
<p>We downloaded a dataset directly from USASpending.gov (<em>“the government”</em>) after entering our desired criteria into the search fields. In an ideal scenario, we would have made use of the API that is provided, however, the timing of our data collection did not provide the conditions for this method.</p>
</section>
<section id="nasdaq-1" class="level4" data-number="3.2.1.2">
<h4 data-number="3.2.1.2" class="anchored" data-anchor-id="nasdaq-1"><span class="header-section-number">3.2.1.2</span> <em>Nasdaq</em></h4>
<p>Nasdaq provides a text file with specific information related to companies listed on the Nasdaq exchange. Such information incldues: company symbol, security name, and market category. In addition, Nasdaq also provides this information for “other” companies which are not listed on the Nasdaq. This text file was read into a dataframe using the Pandas Python library via trivial read function such as <code>pandas.read_csv()</code>.</p>
</section>
<section id="yahoo-finance" class="level4" data-number="3.2.1.3">
<h4 data-number="3.2.1.3" class="anchored" data-anchor-id="yahoo-finance"><span class="header-section-number">3.2.1.3</span> <em>Yahoo Finance</em></h4>
<p>Stock price data was called using Python and the yFinance API. We structured our API call such that only tickers which belonged to government contractors were called. We will discuss our method for distilling those tickers in the next section.</p>
</section>
</section>
<section id="transform" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="transform"><span class="header-section-number">3.2.2</span> Transform</h3>
<section id="cleaning-the-data" class="level4" data-number="3.2.2.1">
<h4 data-number="3.2.2.1" class="anchored" data-anchor-id="cleaning-the-data"><span class="header-section-number">3.2.2.1</span> Cleaning the data</h4>
<p>Stock tickers from the Nasdaq were filtered using Python to ensure there were no duplicate companies and only common stocks were represented in the data. We will refer to this resulting dataset as <code>updated_tickers</code>.</p>
<p>As received, the data we downloaded from <em>the government</em> was all the same data type, which needed to be imported into Python using the proper types. In general, the data was complete, with virtually no missing or corrupted information. We subsetted this dataset to only include features which we would need, such as <code>action_date</code>, <code>recipient_name</code>, and <code>federal_action_obligation</code>. We will refer to this resulting dataset as <code>cleaned_gov_contracts</code>.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><strong>Column</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>action_date</code></td>
<td>Contract award date</td>
</tr>
<tr class="even">
<td><code>recipient_name</code></td>
<td>Company name</td>
</tr>
<tr class="odd">
<td><code>federal_action_obligation</code></td>
<td>Contract amount</td>
</tr>
</tbody>
</table>
<p>Company names (“recipient name”) reflected the official SEC filings, which do not always match the names listed in the stock market. Another finding was the presence of multiple distinct tickers from the same company, which can occur for special types of securities - we will not cover those types in this analysis.</p>
<p>To resolve mismatches and consolidate multiple tickers, we used the rapidfuzz Python package, which provides high-performance “fuzzy” string matching, enabled us to match data from <em>the government</em> and the Nasdaq with high confidence.</p>
</section>
<section id="combining-the-data" class="level4" data-number="3.2.2.2">
<h4 data-number="3.2.2.2" class="anchored" data-anchor-id="combining-the-data"><span class="header-section-number">3.2.2.2</span> Combining the Data</h4>
<p>Using <code>tickers</code> and <code>contracts</code> we used key information like <code>ticker</code> and <code>action_date</code> to make API calls to yFinance and retrieve historical stock data. The <code>ticker</code> information was essential for us to be able to tell yFinance which stock we were interested in. We used <code>action_date</code> (date at which the contract was awarded) as a marker to then request yFinance for stock data near the next earnings call.</p>
</section>
</section>
<section id="load" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="load"><span class="header-section-number">3.2.3</span> Load</h3>
<p>Once the transformation phase was complete, we loaded the cleaned data into a PostgreSQL database hosted in the cloud via Railway—chosen for its ease of use, low cost, and reliable accessibility.</p>
<p>We wrote a Python script to define the schema, create tables, and establish relationships between data tables. Key Python packages used for this stage included <strong>csv</strong> and <strong>psycopg2</strong>, which facilitated seamless interaction with the PostgreSQL database using standard credentials and connection strings.</p>
</section>
</section>
<section id="exploration" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="exploration"><span class="header-section-number">3.3</span> Exploration</h2>
<p>In political discourse, a recurring question is “where” and “why” Congressional spending occurs. To explore the “where,” we examined how federal contract dollars are distributed across U.S. government agencies.</p>
<p>Our initial analysis shows that the <strong>Department of Defense</strong> (DoD) receives the largest allocation of contract funding. Notably, the gap between the top two agencies—DoD and the Department of Veterans Affairs (VA)—is approximately $961 billion, which is substantial. At the opposite end, the Department of Transportation and Department of Commerce receive the least funding.</p>
<div id="fig-spending-top-10" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spending-top-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./eda_plots/top_10_spending.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;3: A representation of government spending by agency"><img src="./eda_plots/top_10_spending.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spending-top-10-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: A representation of government spending by agency
</figcaption>
</figure>
</div>
<p>Building on this, we investigated how DoD funding is distributed among private contractors. We observed that multiple subsidiaries of the same parent company appear among the top recipients of federal funds.</p>
<div id="fig-spending-top-10-defense" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spending-top-10-defense-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./eda_plots/top_10_defense.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;4: A representation of defense spending by contractor"><img src="./eda_plots/top_10_defense.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spending-top-10-defense-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: A representation of defense spending by contractor
</figcaption>
</figure>
</div>
<p>These findings highlight how federal tax dollars can appear to be clustered within a few corporate families, even though the entities receiving the contracts are technically distinct subsidiaries.</p>
<p>Another key finding was the trend in government funding allocation. This situation is particularly noteworthy given the recent change in presidential administration. While it is not immediately clear whether the surge in spending observed in February 2025 is directly related to the transition, it is certainly a development worth monitoring.</p>
<div id="fig-spending-by-month" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-spending-by-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./eda_plots/spending_by_month_year.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5: A timeline of government spending"><img src="./eda_plots/spending_by_month_year.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-spending-by-month-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: A timeline of government spending
</figcaption>
</figure>
</div>
</section>
<section id="analysis" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="analysis"><span class="header-section-number">3.4</span> Analysis</h2>
<section id="why-xgboost-was-chosen" class="level3" data-number="3.4.1">
<h3 data-number="3.4.1" class="anchored" data-anchor-id="why-xgboost-was-chosen"><span class="header-section-number">3.4.1</span> Why XGBoost Was Chosen</h3>
<p>The primary model selected for this study was XGBoost (Extreme Gradient Boosting), chosen for its ability to handle the complex and non-linear relationships inherent in financial data. The interactions between contract size, stock price momentum, earnings timing, and risk signals are not easily captured by linear models. XGBoost is particularly well-suited for this type of data because it can learn non-linear feature interactions automatically, without the need for manual feature transformation. Additionally, XGBoost is also highly robust to multicollinearity and feature noise, both of which are present in our dataset due to the nature of the stock market.</p>
<p>Finally, XGBoost provides strong built-in support for model interpretability, including feature importance metrics and compatibility with SHAP (SHapley Additive Explanations). This interpretability is critical in financial contexts, where transparency is essential for model trustworthiness and actionable decision-making.</p>
</section>
<section id="xgboost-vs.-random-forest-and-logistic-regression" class="level3" data-number="3.4.2">
<h3 data-number="3.4.2" class="anchored" data-anchor-id="xgboost-vs.-random-forest-and-logistic-regression"><span class="header-section-number">3.4.2</span> XGBoost vs.&nbsp;Random Forest and Logistic Regression</h3>
<p>To evaluate the effectiveness of XGBoost, we benchmarked its performance against two alternative models: Random Forest Regressor and Logistic Regression. These models were selected to represent a tree-based ensemble baseline and a simple linear approach, respectively.</p>
<p>While Random Forest provided a strong baseline due to its ensemble nature, it lacked the refinement of gradient boosting. In particular, it struggled to generalize on edge cases involving high-magnitude stock movements, and produced higher average error metrics overall. Its lack of gradient-informed updates meant it required more trees to reach similar performance, yet still underperformed on volatility-sensitive contract events.</p>
<p>Logistic Regression, although computationally efficient and highly interpretable, proved insufficient for the complexity of the task. The model’s inability to capture non-linear relationships or interactions between variables - such as momentum interacting with EPS timing - led to severe underfitting. It consistently failed to predict large price movements and tended to regress predictions toward the mean.</p>
<p>In contrast, XGBoost consistently outperformed both alternatives across all key evaluation metrics. On the test set, it achieved higher R² scores and lower root mean squared error (RMSE) and mean absolute error (MAE). It was particularly effective in cases where contracts were awarded near earnings calls or involved higher-than-average contract risk scores—scenarios that require the model to detect subtle, multi-variable relationships. These comparative results validated the choice of XGBoost as the most reliable and expressive algorithm for capturing short-term stock price movement in response to government contract activity.</p>
</section>
<section id="loss-function" class="level3" data-number="3.4.3">
<h3 data-number="3.4.3" class="anchored" data-anchor-id="loss-function"><span class="header-section-number">3.4.3</span> Loss Function</h3>
<p>The loss function is a foundational component of supervised machine learning. It defines how a model measures error during training and determines the direction and magnitude of updates to improve predictions. In regression tasks, this function quantifies the difference between the model’s predicted value (y-hat​) and the true observed value (y-true), driving the model to minimize that difference across the training data.</p>
<p>In the case of XGBoost, the choice of loss function is especially important because the algorithm relies on second-order gradient boosting. During training, XGBoost applies a Taylor expansion to the loss function to calculate both the gradient (first derivative) and hessian (second derivative) at each prediction point. These derivatives allow the model to construct each tree more efficiently and accurately, enabling fine-grained updates during optimization.</p>
</section>
<section id="pseudo-huber" class="level3" data-number="3.4.4">
<h3 data-number="3.4.4" class="anchored" data-anchor-id="pseudo-huber"><span class="header-section-number">3.4.4</span> Pseudo-Huber</h3>
<p>We ultimately selected the Pseudo-Huber loss function, which blends the best aspects of MSE and MAE. It behaves quadratically for small errors — preserving smoothness for optimization - and linearly for large errors - limiting the influence of outliers. Pseudo-Huber is fully differentiable, making it compatible with XGBoost’s gradient and hessian-based training process. Why Pseudo-Huber Was Chosen</p>
<p>Our target variable — the percent change in a stock price — is highly kurtotic. The distribution is dominated by small movements, punctuated by occasional extreme spikes due to events like large defense contracts or earnings report surprises. In this context, a loss function that overreacts to outliers can skew the model’s learning and reduce generalizability.</p>
</section>
<section id="feature-engineering-and-importance" class="level3" data-number="3.4.5">
<h3 data-number="3.4.5" class="anchored" data-anchor-id="feature-engineering-and-importance"><span class="header-section-number">3.4.5</span> Feature Engineering and Importance</h3>
<p>Our model took into consideration + variables spanning government contracts, stock market data, and earnings per share (EPS) reports. <strong>Figured Y(a)</strong> depict a graph showing which variables the model used most often during training, as well as where the data came from. While <strong>figure Y(b)</strong> has a brief explanation as to how each of these 10 variables were contrived.</p>
<div id="fig-top-10-features" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-top-10-features-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./Users/rudyapodaca/Desktop/summary_bar.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;6: The Top 10 Features of Used by XGBoost Model Training"><img src="./Users/rudyapodaca/Desktop/summary_bar.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-top-10-features-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: The Top 10 Features of Used by XGBoost Model Training
</figcaption>
</figure>
</div>
<p><strong>Figure Y(b)</strong> - Brief Description of top 10 used features by XGBoost during training and tuning.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 26%">
<col style="width: 55%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Feature Name</strong></th>
<th><strong>Description</strong></th>
<th><strong>Data Source</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Contract / Market Cap</td>
<td>Contract value ÷ company’s market cap at the award date.</td>
<td>GovContracts + NASDAQ</td>
</tr>
<tr class="even">
<td>60-Day Average Open-Close</td>
<td>Two-month average difference between stock’s open and close price prior to award date; gives insight to momentum. Compliments 10-day average.</td>
<td>GovContract + yFinance</td>
</tr>
<tr class="odd">
<td>10-day Average Open-close</td>
<td>10-day average difference between stock’s open and close price prior to award date; gives insight to momentum. Compliments 60-day average.</td>
<td>GovContract + yFinance</td>
</tr>
<tr class="even">
<td>Day of the week</td>
<td>The weekday of the contract award (e.g., Monday, Friday). Can capture behavioral anomalies.</td>
<td>GovContract</td>
</tr>
<tr class="odd">
<td>5-Day Avg of Open-Close</td>
<td>5-Day cumulative % price change prior to award.</td>
<td>yFinance</td>
</tr>
<tr class="even">
<td>Days to EPS</td>
<td>Calendar days from the reference date to the ticker’s next earnings release (positive = upcoming).</td>
<td>NASDAQ</td>
</tr>
<tr class="odd">
<td>Holiday?</td>
<td>Boolean flag for whether the contract award date fell near a U.S. market holiday.</td>
<td>yFinance / Calendar</td>
</tr>
<tr class="even">
<td>Day of Week</td>
<td>The weekday of the contract award (e.g., Monday, Friday). Can capture behavioral anomalies.</td>
<td>yFinance</td>
</tr>
<tr class="odd">
<td>Sector</td>
<td>Encoded sector label for the company awarded the contract. Captures long-term institutional sector behavior.</td>
<td>Sector Metadata</td>
</tr>
</tbody>
</table>
</section>
<section id="feature-importance-interpretation" class="level3" data-number="3.4.6">
<h3 data-number="3.4.6" class="anchored" data-anchor-id="feature-importance-interpretation"><span class="header-section-number">3.4.6</span> Feature Importance Interpretation</h3>
<section id="contract-market-cap" class="level4" data-number="3.4.6.1">
<h4 data-number="3.4.6.1" class="anchored" data-anchor-id="contract-market-cap"><span class="header-section-number">3.4.6.1</span> 1. Contract / Market Cap</h4>
<p>Definition: Size of the award(s) relative to the firm’s equity value at the time of award.</p>
<pre><code>        contract_to_cap = federal_action_obligation / market_cap_at_award</code></pre>
<p>The purpose of this features is to normalize across various contract obligations and market-caps — allowing for versatile comparisons.</p>
</section>
<section id="day-average-open-close" class="level4" data-number="3.4.6.2">
<h4 data-number="3.4.6.2" class="anchored" data-anchor-id="day-average-open-close"><span class="header-section-number">3.4.6.2</span> 2. 60-Day Average Open-Close</h4>
<p>Feature name: avg_open_close_delta_60d</p>
<p>Definition: Average intraday return over the prior 60 trading days—captures medium-term intraday drift/behavior.</p>
<pre><code>        Intraday Avg = (open-close) / open</code></pre>
<p>The same intraday average forumula is used for 60-day, 10-day, and 5-day averages. The purpose of the 60-day average is to attain a baseline “how this stock tends to move intraday” over the last quarter.</p>
</section>
<section id="day-average-open-close-1" class="level4" data-number="3.4.6.3">
<h4 data-number="3.4.6.3" class="anchored" data-anchor-id="day-average-open-close-1"><span class="header-section-number">3.4.6.3</span> 3. 10-day Average Open-close</h4>
<p>Feature name: rolling_delta_10d</p>
<p>Definition: Same as above, but over the prior 10 trading days—more reactive to recent market shifts.</p>
</section>
<section id="day-of-the-week" class="level4" data-number="3.4.6.4">
<h4 data-number="3.4.6.4" class="anchored" data-anchor-id="day-of-the-week"><span class="header-section-number">3.4.6.4</span> 4. Day of the week</h4>
<p>Feature name: day_of_week</p>
<p>Definition: Trading-day index for the award date (Mon=0 … Fri=4). Encoded as categorical for the model. Construction.</p>
<pre><code>Extract weekday from the trading calendar aligned to the action date.</code></pre>
<p>Captures known micro-effects (e.g., Monday effect, pre-weekend positioning). Trends tend to compound following announcements on Friday and conversely could stall if announced on a Monday.</p>
</section>
<section id="day-avg-of-open-close" class="level4" data-number="3.4.6.5">
<h4 data-number="3.4.6.5" class="anchored" data-anchor-id="day-avg-of-open-close"><span class="header-section-number">3.4.6.5</span> 5. 5-Day Avg of Open-Close</h4>
<p>Feature name: rolling_delta_5d</p>
<p>Definition: Average intraday % return over the prior 5 trading days—very short-term momentum/mean-reversion signal.</p>
<p>Answers the question of what’s been happening this week between opens and closes?</p>
</section>
</section>
<section id="shap-interpreting-model-behavior" class="level3" data-number="3.4.7">
<h3 data-number="3.4.7" class="anchored" data-anchor-id="shap-interpreting-model-behavior"><span class="header-section-number">3.4.7</span> SHAP: Interpreting Model Behavior</h3>
<p>To understand how the model makes predictions—not just how accurate it is—we apply SHAP (SHapley Additive exPlanations), a method rooted in cooperative game theory. SHAP assigns each feature a contribution value for each prediction, allowing us to quantify and visualize how different features push a prediction higher or lower.</p>
<p>SHAP supports both global interpretability—which features matter most across the entire dataset—and local interpretability, where we can examine individual predictions in detail. Crucially, SHAP also captures directionality, helping us identify whether high or low values of a feature increase or decrease the predicted outcome.</p>
<p>This level of interpretability is especially important in financial contexts, where decisions may be influenced by subtle, nonlinear interactions—such as the interplay between earnings report proximity, contract size, and market volatility. SHAP allows us to validate that the model’s logic aligns with real-world market behavior, making its predictions not just performance, but also transparent and trustworthy.</p>
</section>
<section id="feature-interpretability-and-model-insights" class="level3" data-number="3.4.8">
<h3 data-number="3.4.8" class="anchored" data-anchor-id="feature-interpretability-and-model-insights"><span class="header-section-number">3.4.8</span> Feature Interpretability and Model Insights</h3>
<p>Our SHAP analysis of 5,000 contract award events (Fig. X) revealed distinct patterns in how the model interprets input features. Short-term price momentum, captured by the five-day open-to-close average, and proximity to earnings announcements (measured as days until EPS) consistently exerted the strongest positive influence on predicted stock price movement. Contract awards occurring within one to three trading days prior to an earnings release—particularly when accompanied by recent positive momentum and low volatility—produced the highest positive SHAP values, indicating the model’s expectation of a strong market reaction. Conversely, awards issued during periods of flat or negative momentum were associated with smaller or negative SHAP contributions, even when contract size was substantial. These findings support the hypothesis that government contract announcements primarily function as amplifiers of prevailing market sentiment, with their impact most pronounced when timed around major corporate events such as earnings releases.</p>
<div id="fig-top-10-features" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-top-10-features-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="./Users/rudyapodaca/Desktop/summary_beeswarm.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;7: SHAP Summary: Top 8 Feature Effects"><img src="./Users/rudyapodaca/Desktop/summary_beeswarm.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-top-10-features-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: SHAP Summary: Top 8 Feature Effects
</figcaption>
</figure>
</div>
<p>Figure X: SHAP summary plot of the top 8 features used by the XGBoost model. Each point represents a contract event. Horizontal placement indicates the feature’s effect on the model’s prediction (positive or negative), while color reflects the feature value (red = high, blue = low).</p>
</section>
</section>
</section>
<section id="results" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Results</h1>
<section id="post-tuning" class="level3" data-number="4.0.1">
<h3 data-number="4.0.1" class="anchored" data-anchor-id="post-tuning"><span class="header-section-number">4.0.1</span> Post-Tuning</h3>
<p>After model tuning and feature engineering, the final XGBoost model was evaluated on a 20% holdout test set using key regression performance metrics. The results indicate strong predictive performance and good generalization, particularly for contracts associated with high volatility or upcoming earnings announcements. Tuned XGBoost Model Performance</p>
<p>On the test set, the model achieved the following scores:</p>
<pre><code>R²: 0.7232
Mean Absolute Error (MAE): 0.3608
Root Mean Squared Error (RMSE): 0.9898
Max Error: 37.77
Median Absolute Error: 0.0801</code></pre>
<p>These metrics reflect a strong ability to capture short-term price movement following contract announcements, with relatively low average error and excellent performance in the center of the distribution, as indicated by the very low median absolute error. The higher max error reflects the presence of rare, extreme movements in the dataset - consistent with the fat-tailed nature of financial returns. Performance on Large-Move Contracts</p>
<p>Because high-magnitude price movements are particularly relevant for short-term trading applications, we evaluated the model’s performance on a filtered subset of contract events where the absolute percent change exceeded 10%. Within this high-volatility segment, the model’s R² increased to 0.811, and RMSE decreased to 0.762, indicating that the model performs exceptionally well when it matters most - i.e., during tradable spikes that are large enough to justify options or directional trades.</p>
<p>This behavior reinforces our earlier hypothesis that the model is especially effective at distinguishing signal from noise when strong catalysts are present, such as EPS proximity and momentum alignment.</p>
</section>
<section id="sample-predictions" class="level3" data-number="4.0.2">
<h3 data-number="4.0.2" class="anchored" data-anchor-id="sample-predictions"><span class="header-section-number">4.0.2</span> Sample Predictions</h3>
<p>Below is a sample of model predictions compared to actual T+2 percent changes for selected contract events:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 7%">
<col style="width: 11%">
<col style="width: 17%">
<col style="width: 10%">
<col style="width: 23%">
<col style="width: 29%">
</colgroup>
<thead>
<tr class="header">
<th>Ticker</th>
<th>True Δ (%)</th>
<th>Predicted Δ (%)</th>
<th>EPS Near?</th>
<th>Contract Size (Scaled)</th>
<th>Notes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>ABCD</td>
<td>+12.10</td>
<td>+11.53</td>
<td>Yes</td>
<td>High</td>
<td>Momentum + EPS alignment</td>
</tr>
<tr class="even">
<td>LMNO</td>
<td>-0.84</td>
<td>-0.71</td>
<td>No</td>
<td>Medium</td>
<td>Flat prior volatility</td>
</tr>
<tr class="odd">
<td>XYZ</td>
<td>+15.33</td>
<td>+13.82</td>
<td>Yes</td>
<td>High</td>
<td>Defense contract pre-EPS</td>
</tr>
<tr class="even">
<td>QWER</td>
<td>-3.91</td>
<td>-4.12</td>
<td>No</td>
<td>Low</td>
<td>Small vendor, no momentum</td>
</tr>
</tbody>
</table>
<p>These examples highlight the model’s ability to capture both direction and magnitude of price movement, particularly for earnings-sensitive sectors and contracts with substantial relative size. Comparison to Baseline Models</p>
<p>For benchmarking purposes, the same dataset and feature set were used to train both a Random Forest Regressor and a Logistic Regression model (converted for continuous output). Their test performance was significantly weaker:</p>
<pre><code>Random Forest:
    R²: 0.512
    RMSE: 1.312

Logistic Regression:
    R²: 0.283
    RMSE: 1.841</code></pre>
<p>These models failed to capture the nuanced, interaction-heavy structure of the data. Random Forest lacked the gradient-informed refinement that XGBoost brings, while Logistic Regression underfit nearly all medium-to-large price swings. Summary of Strengths and Limitations</p>
<p>The XGBoost model demonstrated strong overall performance, with particularly high accuracy on high-volatility contract events. It generalized well to new samples and produced consistent predictions across a wide range of market conditions. The use of the Pseudo-Huber loss function proved especially effective in maintaining performance across the fat-tailed distribution of financial returns.</p>
<p>Limitations include occasional overprediction on small-cap stocks with limited trading volume, and underprediction in sectors with less consistent contract-to-movement patterns (e.g., telecom or energy services). Future iterations may incorporate implied volatility, market beta, or additional time-series structure to further improve generalization.</p>
</section>
</section>
<section id="conclusions" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Conclusions</h1>
<p>This project developed a machine learning model to predict short-term stock price movement following a government contract award, with particular focus on how this response is modulated by earnings proximity, momentum, and contract characteristics. Using an XGBoost regression model and a Pseudo-Huber loss function, we trained the system to estimate the two-day percent change in stock price following a contract event.</p>
<p>The final model demonstrated strong predictive performance on out-of-sample data, achieving an R² of 0.72, MAE of 0.36, and RMSE under 1.0. These metrics indicate that the model captured a meaningful portion of short-term stock movement, while maintaining robustness in the presence of outliers and noise. The median absolute error of just 0.08% shows exceptional performance for the majority of “normal” contract events, and the model performed especially well when price movement exceeded ±10%.</p>
<p>Feature interpretability using SHAP confirmed that the model learned intuitive market behavior, assigning high importance to features like short-term momentum, days until earnings, and contract-normalized volatility. The model appeared to detect not only contract significance, but also the context in which contracts are awarded, particularly during high-signal periods like earnings week.</p>
<pre><code>R²: 0.7232
Mean Absolute Error (MAE): 0.3608
Root Mean Squared Error (RMSE): 0.9898
Max Error: 37.77
Median Absolute Error: 0.0801</code></pre>
<section id="ethical-considerations" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="ethical-considerations"><span class="header-section-number">5.1</span> Ethical Considerations</h2>
<p>All of our data was ultimately sourced from publicly available resources, allowing us to leverage existing infrastructure without ethical or legal concerns related to proprietary information. In working with this data, we aimed to include as much relevant information as possible without compromising accuracy or validity.</p>
<section id="privacy" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="privacy"><span class="header-section-number">5.1.1</span> Privacy</h3>
<p>During the early stages of data acquisition, we considered using a paid service called Tiingo to address some challenges we encountered while scraping data from public sources. However, after creating a free Tiingo account, we found that its API access was limited to a small number of calls per hour, which would have significantly slowed our data collection process. Additionally, Tiingo’s user agreement explicitly prohibits redistribution of its data, which conflicted with our plans for showcasing and presenting our results. As a result, we opted to explore alternative, fully public sources for our data needs.</p>
<p>Ultimately, our public data scraping strategy was successful. The data we collected—such as stock prices and ticker symbols—was entirely sourced from public domains. Because stock market data is inherently public and widely disseminated, we did not encounter any privacy concerns or require access to personally identifiable information.</p>
</section>
<section id="biases" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="biases"><span class="header-section-number">5.1.2</span> Biases</h3>
<p>When working with financial data, it is important to acknowledge the inherent volatility and sensitivity of markets to external events. Trends and disruptions may occur that cannot be fully explained by data alone. For instance, during the COVID-19 pandemic, the stock market experienced significant and unprecedented shifts that diverged from prior historical patterns. Analyzing data that spans such anomalous periods without accounting for those external factors may lead to misleading conclusions.</p>
<p>Our dataset covers a relatively short time period and does not include data from the height of the COVID-19 pandemic. Due to hardware limitations, we were unable to process a broader historical dataset. Had we included such a time span, it would have required additional processing power to model, and to take into account the pandemic’s macroeconomic effects. Although we acknowledge that the COVID-19 pandemic caused lasting changes in market behavior, our analysis does not explicitly account for those factors.</p>
<p>Furthermore, our data is limited to companies listed on the New York Stock Exchange (NYSE) and NASDAQ. While these exchanges represent a significant portion of the U.S. stock market, they are not all encompassing of the United States market. Other exchanges—such as Miami International Holdings, the Long-Term Stock Exchange (LTSE), and Investors Exchange (IEX)—were not included in this analysis, which may limit the generalizability of our findings.</p>
</section>
</section>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<div class="{@Zelner2022}">
<div class="Yfinance">

</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>